module.exports=function(e,r){var t=require("./util"),n=t.errorObj,u=t.isObject;var o={}.hasOwnProperty;return function tryConvertToPromise(c,l){if(u(c)){if(c instanceof e)return c;var i=function getThen(e){try{return function doGetThen(e){return e.then}(e)}catch(e){return n.e=e,n}}(c);if(i===n){l&&l._pushContext();var a=e.reject(i.e);return l&&l._popContext(),a}if("function"==typeof i){if(function isAnyBluebirdPromise(e){try{return o.call(e,"_promise0")}catch(e){return!1}}(c)){a=new e(r);return c._then(a._fulfill,a._reject,void 0,a,null),a}return function doThenable(u,o,c){var l=new e(r),i=l;c&&c._pushContext();l._captureStackTrace(),c&&c._popContext();var a=!0,f=t.tryCatch(o).call(u,resolve,reject);a=!1,l&&f===n&&(l._rejectCallback(f.e,!0,!0),l=null);function resolve(e){l&&(l._resolveCallback(e),l=null)}function reject(e){l&&(l._rejectCallback(e,a,!0),l=null)}return i}(c,i,l)}}return c}};