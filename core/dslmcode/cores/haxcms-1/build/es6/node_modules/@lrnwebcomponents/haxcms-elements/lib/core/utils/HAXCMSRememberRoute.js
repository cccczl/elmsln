import{store as t}from"../haxcms-site-store.js";import{autorun as e,toJS as a}from"../../../../../mobx/dist/mobx.esm.js";function localStorageGet(t){try{return localStorage.getItem(t)}catch(t){return!1}}const HAXCMSRememberRoute=function(s){return class extends s{constructor(){super();const s="Resume where you left off last session?";this.menuOpen=!0,this.__evaluateRoute=!1,this.t?(this.t.resumeMessage=s,this.t.resume="Resume"):this.t={resumeMessage:s,resume:"Resume"},e((e=>{const s=a(t.location.pathname);s&&this.__evaluateRoute&&function localStorageSet(t,e){try{return localStorage.setItem(t,e)}catch(t){return!1}}(`HAXCMSlastRoute-${t.manifest.metadata.site.name}`,s)}))}firstUpdated(e){super.firstUpdated&&super.firstUpdated(e),setTimeout((()=>{t&&t.location&&t.location.pathname&&localStorageGet(`HAXCMSlastRoute-${t.manifest.metadata.site.name}`)&&localStorageGet(`HAXCMSlastRoute-${t.manifest.metadata.site.name}`)!=a(t.location.pathname)&&import("../../../../simple-toast/simple-toast.js").then((()=>{window.SimpleToast.requestAvailability();let e=document.createElement("a");e.setAttribute("href",localStorageGet(`HAXCMSlastRoute-${t.manifest.metadata.site.name}`)),e.addEventListener("click",this.resumeLastRoute.bind(this)),e.innerHTML=`<button>${this.t.resume}</button>`;new URLSearchParams(window.location.search).get("format")||t.toast(this.t.resumeMessage,8e3,"capsule",null,null,e)})),this.__evaluateRoute=!0}),1e3)}resumeLastRoute(t){window.dispatchEvent(new CustomEvent("simple-toast-hide",{bubbles:!0,composed:!0,cancelable:!1,detail:!1}))}}};export{HAXCMSRememberRoute};