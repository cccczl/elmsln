var r=require("./util"),e=r.maybeWrapAsError,a=require("./errors").OperationalError,t=require("./es5");var n=/^(?:name|message|stack|cause)$/;function wrapAsOperationalError(e){var o;if(function isUntypedError(r){return r instanceof Error&&t.getPrototypeOf(r)===Error.prototype}(e)){(o=new a(e)).name=e.name,o.message=e.message,o.stack=e.stack;for(var i=t.keys(e),s=0;s<i.length;++s){var l=i[s];n.test(l)||(o[l]=e[l])}return o}return r.markAsOriginatingFromRejection(e),e}module.exports=function nodebackForPromise(r,a){return function(t,n){if(null!==r){if(t){var o=wrapAsOperationalError(e(t));r._attachExtraTrace(o),r._reject(o)}else if(a){for(var i=arguments.length,s=new Array(Math.max(i-1,0)),l=1;l<i;++l)s[l-1]=arguments[l];r._fulfill(s)}else r._fulfill(n);r=null}}};